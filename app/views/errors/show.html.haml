.row
  .col-sm-3#error-sidebar
    = render partial: 'errors_sidebar'
  .col-sm-9#error-details
    .header.no-margin
      .row
        .col-xs-1.times_seen
          = @error.times_seen
        .col-xs-7
          %div.message= @error.message
          %ul.list-inline
            %li
              %span.badge.badge-subscribers
                = icon('users')
                = @error.users_affected
            %li
              %span.badge.badge-environment= @error.environment
            %li
              %span.label.badge= @error.checksum
        .col-xs-4.text-right
          .btn-group
            = paginate @issues, theme: 'next_prev_theme', param_name: :page_issue
          .btn-group.resolve
            = button_to "#{@error.resolved? ? 'Unresolve' : 'Resolve'}", resolve_error_path(error_ids: [@error.id], "#{@error.resolved? ? 'unresolved' : 'resolved'}": true), class: "btn pull-right #{@error.resolved? ? 'btn-danger' : 'btn-primary'} ", method: :put, id: 'resolve-button'
    .error-content{"data-id" => "#{@error.id}"}
      .row
        .col-lg-12
          #custom-bootstrap.navbar.navbar-default{:role => "navigation"}
            %ul.nav.navbar-nav.navbar-left.main-tabs
              %li{ class: "#{params[:current_tab] == 'overview' || params[:current_tab].nil? ? 'active' : ''}" }
                = link_to "Overview", request.parameters.merge({current_tab: 'overview'})
              %li{ class: "#{params[:current_tab] == 'aggregations' ? 'active' : ''}" }
                = link_to "Aggregations", request.parameters.merge({current_tab: 'aggregations'})

          .tab-content
            #overview.tab-pane{ class: "#{params[:current_tab] == 'overview' || params[:current_tab].nil? ? 'active' : ''}" }
              = render partial: 'errors/error-partials/overview'
            #aggregations.tab-pane{ class: "#{params[:current_tab] == 'aggregations' ? 'active' : ''}" }
            - if params[:current_tab] == 'aggregations'
              #accordion.panel-group
                = render partial: 'errors/error-partials/aggregations', locals: { title: 'Messages', type: "Message", data: @error.aggregations[:messages], panel: "One" }
                = render partial: 'errors/error-partials/aggregations', locals: { title: 'Subscribers', type: "Name", data: @error.aggregations[:subscribers], panel: "Two" }
                = render partial: 'errors/error-partials/aggregations', locals: { title: 'Browsers', type: "Browser", data: @error.aggregations[:browsers], panel: "Three" }
